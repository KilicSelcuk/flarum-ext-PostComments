{"version":3,"file":"forum.js","mappings":";;;;;;;;;;;;;;AAAA;AAEAA,yEAAA,CAAqB,qCAArB,EAA4D,YAAM;EAChEG,OAAO,CAACC,GAAR,CAAY,+DAAZ;AACD,CAFD;;;;;;;;;;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AAEe,SAASO,QAAT,GAAoB;EACjCL,6DAAQ,CAACC,+EAAD,EAAiB,QAAjB,EAA2B,YAAW;IAC5C,IAAMM,QAAQ,GAAG,KAAKC,CAAL,CAAO,eAAP,CAAjB;IACA,IAAMC,SAAS,GAAG,KAAKD,CAAL,CAAO,gBAAP,CAAlB;IAEAC,SAAS,CAACC,EAAV,CAAa,WAAb,EAA0B,YAAW;MACnCF,CAAC,CAAC,IAAD,CAAD,CAAQG,WAAR,CAAoB,MAApB;IACD,CAFD;EAGD,CAPO,CAAR;EAUAZ,2DAAM,CAACE,+EAAD,EAAiB,MAAjB,EAAyB,UAAUW,IAAV,EAAgB;IAC7C,IAAMC,EAAE,GAAG,KAAKC,KAAL,CAAWC,IAAX,CAAgBF,EAAhB,EAAX;;IACA,IAAI,CAACnB,GAAG,CAACsB,KAAJ,CAAUC,KAAf,EAAsB;MACpBvB,GAAG,CAACsB,KAAJ,CAAUC,KAAV,GAAkB,EAAlB;MACAvB,GAAG,CAACsB,KAAJ,CAAUE,QAAV,GAAqB,EAArB;IACD;;IACD,IAAI,CAACxB,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,CAAL,EAA0B;MACxBnB,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,IAAsB,EAAtB;MACAnB,GAAG,CAACsB,KAAJ,CAAUE,QAAV,CAAmBL,EAAnB,IAAyB,CAAzB;IACD;;IAED,IAAInB,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,EAAoBM,MAApB,GAA6B,CAAjC,EAAoC;MAClCP,IAAI,CAACQ,QAAL,CAAcC,IAAd,CACE;QAAK,SAAS,EAAC,aAAf;QAA6B,EAAE,EAAER;MAAjC,GACGV,gEAAI,CAAC,cAAD,CADP,EAEGT,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,EAAoBS,MAApB,CAA2B,UAACC,KAAD,EAAQC,KAAR,EAAeC,IAAf;QAAA,OAAwBA,IAAI,CAACC,SAAL,CAAe,UAAAC,CAAC;UAAA,OAAIA,CAAC,CAACd,EAAF,OAAWU,KAAK,CAACV,EAAN,EAAf;QAAA,CAAhB,MAA+CW,KAAvE;MAAA,CAA3B,EACEI,IADF,CACO,UAACC,CAAD,EAAIC,CAAJ,EAAU;QACd,OAAOD,CAAC,CAACE,SAAF,KAAgBD,CAAC,CAACC,SAAF,EAAvB;MACD,CAHF,EAGIC,GAHJ,CAGQ,UAAAjB,IAAI,EAAI;QACb,OAAOX,oFAAA,CAAsB;UAACW,IAAI,EAAJA;QAAD,CAAtB,CAAP;MACD,CALF,CAFH,CADF;IAWD;;IAEDlB,OAAO,CAACC,GAAR,CAAY,KAAKgB,KAAL,CAAWC,IAAX,CAAgBmB,IAAhB,CAAqBC,UAArB,CAAgCC,UAA5C;;IAEA,IAAI,KAAKtB,KAAL,CAAWC,IAAX,CAAgBmB,IAAhB,CAAqBC,UAArB,CAAgCC,UAAhC,GAA6C1C,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,EAAoBM,MAApB,GAA6BzB,GAAG,CAACsB,KAAJ,CAAUE,QAAV,CAAmBL,EAAnB,CAA1E,IAAqGnB,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,EAAoBM,MAApB,KAA+B,CAA/B,IAAoC,KAAKL,KAAL,CAAWC,IAAX,CAAgBmB,IAAhB,CAAqBC,UAArB,CAAgCC,UAA7K,EAA0L;MACxL,IAAMC,KAAK,GAAG,KAAKvB,KAAL,CAAWC,IAAX,CAAgBmB,IAAhB,CAAqBC,UAArB,CAAgCC,UAAhC,GAA6C1C,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,EAAoBM,MAAjE,GAA0EzB,GAAG,CAACsB,KAAJ,CAAUE,QAAV,CAAmBL,EAAnB,CAAxF;MACA,IAAIyB,OAAO,GAAG,oDAAd;;MACA,IAAI5C,GAAG,CAACC,YAAJ,CAAiB4C,GAAjB,CAAqB,kBAArB,CAAJ,EAA8C;QAC5CD,OAAO,IAAI,qBAAX;MACD;;MACD,IAAI5C,GAAG,CAACC,YAAJ,CAAiB4C,GAAjB,CAAqB,eAArB,CAAJ,EAA2C;QACzCD,OAAO,IAAI,WAAX;MACD;;MACD1B,IAAI,CAACQ,QAAL,CAAcC,IAAd,CACEnB,+EAAA,CAAiB;QACfsC,SAAS,EAAE,4CADI;QAEfrC,IAAI,EAAE,mBAFS;QAGfsC,OAAO,EAAE,mBAAM;UACb/C,GAAG,CAACgD,KAAJ,CAAUC,IAAV,CAAe,OAAf,EAAwB9B,EAAxB,EAA4B;YAACyB,OAAO,EAAEA,OAAO,CAACM,OAAR,CAAgB,OAAhB,EAAyB,EAAzB;UAAV,CAA5B,EACGC,IADH,CACQ,UAAAC,QAAQ,EAAI;YAChB,OAAOA,QAAQ,CAACC,OAAhB;YACA,GAAG1B,IAAH,CAAQ2B,KAAR,CAActD,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,CAAd,EAAmCiC,QAAnC;YACAG,CAAC,CAACC,MAAF;UACD,CALH;QAMD;MAVc,CAAjB,EAWGxD,GAAG,CAACyD,UAAJ,CAAeC,KAAf,CAAqB,2CAA2Cf,KAAK,GAAG,CAAR,GAAY,SAAZ,GAAwB,OAAnE,CAArB,EAAkG;QAACA,KAAK,EAALA;MAAD,CAAlG,CAXH,CADF;MAcA3C,GAAG,CAACgD,KAAJ,CAAUC,IAAV,CAAe,OAAf,EAAwB9B,EAAxB,EAA4B;QAACyB,OAAO,EAAEA,OAAO,CAACM,OAAR,CAAgB,OAAhB,EAAyB,EAAzB;MAAV,CAA5B,EACGC,IADH,CACQ,UAAAC,QAAQ,EAAI;QAChB,OAAOA,QAAQ,CAACC,OAAhB;QACA,GAAG1B,IAAH,CAAQ2B,KAAR,CAActD,GAAG,CAACsB,KAAJ,CAAUC,KAAV,CAAgBJ,EAAhB,CAAd,EAAmCiC,QAAnC;QACAG,CAAC,CAACC,MAAF;MACD,CALH;IAMD;EACF,CAzDK,CAAN;AA0DD;;AACD,SAASG,iBAAT,GAA6B;EAC3B,IAAIC,KAAK,GAAGC,QAAQ,CAACC,sBAAT,CAAgC,wBAAhC,CAAZ;;EACA,KAAI,IAAIC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACH,KAAK,CAACnC,MAArB,EAA4BsC,CAAC,EAA7B,EAAiC;IAC/B,IAAIH,KAAK,CAACG,CAAD,CAAL,CAASC,OAAT,CAAiBC,WAAjB,OAAmC,QAAvC,EACEL,KAAK,CAACG,CAAD,CAAL,CAASG,KAAT;EACH;AACF;;AACDC,MAAM,CAACC,MAAP,GAAgB,YAAU;EACxBC,WAAW,CAACV,iBAAiB,EAAlB,EAAsB,IAAtB,CAAX;AACD,CAFD;;;;;;;;;;;;;;;ACnFA;AAEA;AAEA3D,wEAAA,CAAqB,qCAArB,EAA4D,YAAM;EAEhEW,qDAAQ;AAGT,CALD;;;;;;;;;;;ACJA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;ACNA","sources":["webpack://@kilicselcuk/flarum-ext-postcomments/./src/common/index.ts","webpack://@kilicselcuk/flarum-ext-postcomments/./src/forum/MakeTree.js","webpack://@kilicselcuk/flarum-ext-postcomments/./src/forum/index.ts","webpack://@kilicselcuk/flarum-ext-postcomments/external root \"flarum.core.compat['common/app']\"","webpack://@kilicselcuk/flarum-ext-postcomments/external root \"flarum.core.compat['forum/app']\"","webpack://@kilicselcuk/flarum-ext-postcomments/external root \"flarum.core.compat['forum/components/Button']\"","webpack://@kilicselcuk/flarum-ext-postcomments/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@kilicselcuk/flarum-ext-postcomments/external root \"flarum.core.compat['forum/components/Post']\"","webpack://@kilicselcuk/flarum-ext-postcomments/external root \"flarum.core.compat['forum/extend']\"","webpack://@kilicselcuk/flarum-ext-postcomments/external root \"flarum.core.compat['forum/helpers/icon']\"","webpack://@kilicselcuk/flarum-ext-postcomments/webpack/bootstrap","webpack://@kilicselcuk/flarum-ext-postcomments/webpack/runtime/compat get default export","webpack://@kilicselcuk/flarum-ext-postcomments/webpack/runtime/define property getters","webpack://@kilicselcuk/flarum-ext-postcomments/webpack/runtime/hasOwnProperty shorthand","webpack://@kilicselcuk/flarum-ext-postcomments/webpack/runtime/make namespace object","webpack://@kilicselcuk/flarum-ext-postcomments/./forum.ts"],"sourcesContent":["import app from 'flarum/common/app';\n\napp.initializers.add('kilicselcuk/flarum-ext-postcomments', () => {\n  console.log('[kilicselcuk/flarum-ext-postcomments] Hello, forum and admin!');\n});\n","import {extend, override} from 'flarum/forum/extend';\nimport Post from 'flarum/forum/components/Post';\nimport Button from 'flarum/forum/components/Button';\nimport icon from 'flarum/forum/helpers/icon';\nimport CommentPost from 'flarum/forum/components/CommentPost';\n\nexport default function MakeTree() {\n  override(Post.prototype, 'config', function() {\n    const $actions = this.$('.Post-actions');\n    const $controls = this.$('.Post-controls');\n\n    $controls.on('click tap', function() {\n      $(this).toggleClass('open');\n    });\n  });\n\n\n  extend(Post.prototype, 'view', function (vdom) {\n    const id = this.attrs.post.id();\n    if (!app.cache.trees) {\n      app.cache.trees = {};\n      app.cache.pushTree = {};\n    }\n    if (!app.cache.trees[id]) {\n      app.cache.trees[id] = [];\n      app.cache.pushTree[id] = 0;\n    }\n\n    if (app.cache.trees[id].length > 0) {\n      vdom.children.push(\n        <div className='CommentTree' id={id}>\n          {icon('fas fa-reply')}\n          {app.cache.trees[id].filter((thing, index, self) => self.findIndex(t => t.id() === thing.id()) === index)\n            .sort((a, b) => {\n              return a.createdAt() - b.createdAt();\n            }).map(post => {\n              return CommentPost.component({post});\n            })}\n        </div>\n      )\n    }\n\n    console.log(this.attrs.post.data.attributes.replyCount);\n\n    if (this.attrs.post.data.attributes.replyCount > app.cache.trees[id].length - app.cache.pushTree[id] || (app.cache.trees[id].length === 0 && this.attrs.post.data.attributes.replyCount)) {\n      const count = this.attrs.post.data.attributes.replyCount - app.cache.trees[id].length + app.cache.pushTree[id];\n      let include = 'discussion,user,user.groups,hiddenUser,editedUser,';\n      if (app.initializers.has('fof-gamification')) {\n        include += 'user.ranks,upvotes,';\n      }\n      if (app.initializers.has('fof/reactions')) {\n        include += 'reactions';\n      }\n      vdom.children.push(\n        Button.component({\n          className: 'Button Button--link KuazaPostComment--show',\n          icon: 'fas fa-caret-down',\n          onclick: () => {\n            app.store.find('trees', id, {include: include.replace(/,\\s*$/, \"\")})\n              .then(response => {\n                delete response.payload;\n                [].push.apply(app.cache.trees[id], response);\n                m.redraw();\n              })\n          }\n        }, app.translator.trans('kuaza-ext-hadilutfen.forum.post.show_' + (count > 1 ? 'replies' : 'reply'), {count}))\n      );\n      app.store.find('trees', id, {include: include.replace(/,\\s*$/, \"\")})\n        .then(response => {\n          delete response.payload;\n          [].push.apply(app.cache.trees[id], response);\n          m.redraw();\n        })\n    }\n  })\n}\nfunction autoShowEvergreen() {\n  var elems = document.getElementsByClassName(\"KuazaPostComment--show\");\n  for(var i=0; i<elems.length;i++) {\n    if( elems[i].tagName.toLowerCase() === \"button\" )\n      elems[i].click();\n  }\n}\nwindow.onload = function(){\n  setInterval(autoShowEvergreen(), 1500)\n}\n","import app from 'flarum/forum/app';\n\nimport MakeTree from './MakeTree';\n\napp.initializers.add('kilicselcuk/flarum-ext-postcomments', () => {\n\n  MakeTree();\n\n\n});\n","module.exports = flarum.core.compat['common/app'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/Button'];","module.exports = flarum.core.compat['forum/components/CommentPost'];","module.exports = flarum.core.compat['forum/components/Post'];","module.exports = flarum.core.compat['forum/extend'];","module.exports = flarum.core.compat['forum/helpers/icon'];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export * from './src/common';\nexport * from './src/forum';\n"],"names":["app","initializers","add","console","log","extend","override","Post","Button","icon","CommentPost","MakeTree","prototype","$actions","$","$controls","on","toggleClass","vdom","id","attrs","post","cache","trees","pushTree","length","children","push","filter","thing","index","self","findIndex","t","sort","a","b","createdAt","map","component","data","attributes","replyCount","count","include","has","className","onclick","store","find","replace","then","response","payload","apply","m","redraw","translator","trans","autoShowEvergreen","elems","document","getElementsByClassName","i","tagName","toLowerCase","click","window","onload","setInterval"],"sourceRoot":""}